<?php

// Hierin worden alle vragen gesteld, en gerandomized teruggegeven voor hints :)

$vraag["kort"][1][0][0] = "cattenbroekerplas";
$vraag["kort"][1][0][1] = "cattenbroekerstrand";
$vraag["kort"][1][1][0] = "Cattenbroekerplas";
$vraag["kort"][1][1][1] = "De Singel";
$vraag["kort"][1][1][2] = "Wijkpark Molenvliet";
$vraag["kort"][1][1][3] = "Westdampark";
$vraag["kort"][1][2][0] = "Okay, tijd voor de eerste vraag! Dit plekje in Woerden is vaak een rustige plek, totdat de zomer er weer aankomt. Er worden 's avonds feesten gehouden, maar mensen liggen 
overdag heerlijk te zonnebaden. Het ligt niet aan een doorgaande weg, waardoor er beperkte parkeerruimte is. Het ligt in een gedeelte in Woerden met bedrijven en lange straten met huizen.";
$vraag["kort"][1][2][1] = "Op deze locatie is er de mogelijkheid om aan een klein strandje te liggen en te zwemmen.";
$vraag["kort"][1][2][2] = "Er is ook de mogelijkheid om te zeilen, een stukje verderop.";
$vraag["kort"][1][2][3] = "Er worden ook festivals georganiseerd op deze locatie. Denk aan 90's on the beach!";

$vraag["kort"][2][0][0] = "escapepool";
$vraag["kort"][2][1][0] = "Escapepool Woerden/Harmelen";
$vraag["kort"][2][1][1] = "Escaperoom Woerden";
$vraag["kort"][2][1][2] = "Boerderij de Boerinn";
$vraag["kort"][2][1][3] = "Kameryck";
$vraag["kort"][2][2][0] = "Op naar de tweede! Op deze plek valt één van de leuke activiteiten van Woerden te doen. Het heeft wel een speciaal concept dat amper of nergens te vinden is.
 Het is in de open lucht, en dichtbij cattenbroekerplas.";
$vraag["kort"][2][2][1] = "Je hebt hier andere spullen voor nodig dan je normale kleding.";
$vraag["kort"][2][2][2] = "Denk aan duikspullen!";
$vraag["kort"][2][2][3] = "Dit is een escaperoom met een ander concept!";

$vraag["kort"][3][0][0] = "harmelen";
$vraag["kort"][3][0][1] = "herdenking";
$vraag["kort"][3][0][2] = "treinramp";
$vraag["kort"][3][1][0] = "Herdenkingsmonument Harmelen";
$vraag["kort"][3][1][1] = "Station Woerden";
$vraag["kort"][3][1][2] = "Groenendijk Bedrijfskleding";
$vraag["kort"][3][1][3] = "Oosteinde";
$vraag["kort"][3][2][0] = "Een andere vraag dan de eerste twee: Waar is deze foto van, en wat zou de volgende locatie zijn?";
$vraag["kort"][3][2][1] = "Op deze plek is een ramp gebeurd dat in het nieuws is geweest. Het dateert uit ongeveer een halve eeuw geleden.";
$vraag["kort"][3][2][2] = "Deze plek heeft zijn eigen monument gekregen.";
$vraag["kort"][3][2][3] = "Het is niet in Woerden te vinden, maar ligt op het traject van Woerden naar Utrecht.";
$vraag["kort"][3][3][0] = "img";
$vraag["kort"][3][3][1] = "media/images/cp3kort.jpg";

$vraag["kort"][4][0][0] = "oortjespad";
$vraag["kort"][4][1][0] = "Oortjespad";
$vraag["kort"][4][1][1] = "De Boerinn";
$vraag["kort"][4][1][2] = "Golfbaan Bentwoud";
$vraag["kort"][4][1][3] = "BatensteinBuiten";
$vraag["kort"][4][2][0] = "Rebustijd!";
$vraag["kort"][4][2][1] = "Geen hints beschikbaar ;)";
$vraag["kort"][4][2][2] = "Geen hints beschikbaar ;)";
$vraag["kort"][4][2][3] = "Geen hints beschikbaar ;)";
$vraag["kort"][4][3][0] = "img";
$vraag["kort"][4][3][1] = "media/images/tussenstop.png";


$vraag["kort"][5][0][0] = "schulenburch";
$vraag["kort"][5][1][0] = "De Schulenburch";
$vraag["kort"][5][1][1] = "Milandhof";
$vraag["kort"][5][1][2] = "Snellerpoort";
$vraag["kort"][5][1][3] = "De Vaart";
$vraag["kort"][5][2][0] = "En weer terug naar de eerste soort vragen. De volgende locatie is een locatie waar sommige van onze leden zich ook huis houden! Deze locatie zit naast een sportvereniging, 
en deze locatie kan ook afgehuurd worden.Er zit zelfs nog een bibliotheek naast of erbij, dus kortom veelzijdig!";
$vraag["kort"][5][2][1] = "In dit gebouw bevindt muziekvereniging Nieuw Leven Kamerik.";
$vraag["kort"][5][2][2] = "Op de weg van Kamerik naar Kanis is dit gebouw te vinden.";
$vraag["kort"][5][2][3] = "Naast dit gebouw zit voetbalvereniging Kamerik.";

$vraag["kort"][6][0][0] = "excelsior";
$vraag["kort"][6][0][1] = "speeldozen";
$vraag["kort"][6][0][2] = "clubhuis";
$vraag["kort"][6][1][0] = "Excelsior";
$vraag["kort"][6][1][1] = "Het clubhuis";
$vraag["kort"][6][1][2] = "De Speeldozen";
$vraag["kort"][6][1][3] = "Het clubhuis van Excelsior, de Speeldozen";
$vraag["kort"][6][2][0] = "We zijn alweer bijna aan het einde van de route gekomen! We gaan naar de laatste stop en het eindpunt van de tocht, en dat is:";
$vraag["kort"][6][2][1] = "Niet zo moeilijk denken hoor!";
$vraag["kort"][6][2][2] = "Tja, waar zijn we vandaag gestart?";
$vraag["kort"][6][2][3] = "Even die hersens laten kraken...";

$vraag["lang"][1][0][0] = "snellerpoort";
$vraag["lang"][1][1][0] = "Sporthal Snellerpoort";
$vraag["lang"][1][1][1] = "Sporthal bij de Regenboogschool";
$vraag["lang"][1][1][2] = "Thijs van der Polshal";
$vraag["lang"][1][1][3] = "Sporthal Bullewijk";
$vraag["lang"][1][2][0] = "In dit gebouw hebben een aantal grote concerten plaatsgevonden. Het ligt redelijk aan de rand van Woerden, waardoor er in de buurt niet veel gebeurt qua activiteiten. 
Er zijn wel meerdere sportclubs actief in en rondom het gebouw.";
$vraag["lang"][1][2][1] = "Naast dit gebouw zit ook een middelbare school, en deze wordt ook afgehuurd door de school.";
$vraag["lang"][1][2][2] = "Het bevindt zich in waterrijk.";
$vraag["lang"][1][2][3] = "In de buurt zit een voetbalvereniging, namelijk SC Woerden.";

$vraag["lang"][2][0][0] = "vijverbos";
$vraag["lang"][2][1][0] = "Het Vijverbos";
$vraag["lang"][2][1][1] = "Landgoed Bredius";
$vraag["lang"][2][1][2] = "Linschoterbos";
$vraag["lang"][2][1][3] = "Bos over Holland";
$vraag["lang"][2][2][0] = "De volgende locatie is een bos buiten Woerden. De naam van het bos is afgeleid van een watertype. Klein watertype... 
En op de hints klikken is niet erg hè, zeker bij deze niet!";
$vraag["lang"][2][2][1] = "Het bos ligt nabij Harmelen";
$vraag["lang"][2][2][2] = "Denk aan alle verschillende watertypes... Zee, meer, rivier, sloot, vijver...";
$vraag["lang"][2][2][3] = "Het type water kan zich ook achter huizen bevinden.";

$vraag["lang"][3][0][0] = "kasteel de haar";
$vraag["lang"][3][0][1] = "de haar";
$vraag["lang"][3][0][2] = "kasteel haar";
$vraag["lang"][3][0][0] = "Kasteel de Haar";
$vraag["lang"][3][0][0] = "Kasteel Woerden";
$vraag["lang"][3][0][0] = "Kasteel Gouda";
$vraag["lang"][3][0][0] = "Kasteel Montfoort";
$vraag["lang"][3][0][0] = "De volgende locatie is behoorlijk bekend in de buurt, maar ook door andere gedeeltes in Nederland door zijn uiterlijk en activiteiten. Het neemt een groot oppervlakte in 
beslag.";
$vraag["lang"][3][0][0] = "Het gebouw staat al een behoorlijke tijd op zijn plek, en komt uit een tijdperk waar sommige festivals die er plaatsvinden hun thema's vandaan halen.";
$vraag["lang"][3][0][0] = "Het gebouw is deels vernoemd naar het dorpje wat erbij ligt.";
$vraag["lang"][3][0][0] = "Velen van de festivals zijn verkleed met een thema in gedachte wat heel stoer en leuk is als kind zijnde. Om zowel als rollenspel of als 
kleine poppetjes mee te spelen. Denk aan... Robin Hood?";

$vraag["lang"][4][0][0] = "klein limburg";
$vraag["lang"][4][0][1] = "limburg";
$vraag["lang"][4][1][0] = "Limburg?";
$vraag["lang"][4][1][1] = "Zuid-Holland?";
$vraag["lang"][4][1][2] = "Noord-Brabant?";
$vraag["lang"][4][1][3] = "Zeeland?";
$vraag["lang"][4][2][0] = "Tijd voor een geluidsfragment! Welke provincie komt deze band vandaan, en wat zou de volgende locatie zijn?";
$vraag["lang"][4][2][1] = "De band is Rowwen Hèze";
$vraag["lang"][4][2][2] = "Luister naar het dialect in het nummer";
$vraag["lang"][4][2][3] = "In het zuiden van het land, waar de bergen bijna zouden bestaan...";
$vraag["lang"][4][3][0] = "audio";
$vraag["lang"][4][3][1] = "media/audio/cp4.mp3";

$vraag["lang"][5][0][0] = "kockengen";
$vraag["lang"][5][1][0] = "Kockengen";
$vraag["lang"][5][1][1] = "Haarzuilens";
$vraag["lang"][5][1][2] = "Maarssen";
$vraag["lang"][5][1][3] = "Vleuten";
$vraag["lang"][5][2][0] = "De volgende stop is weer een plaatsje wat zelf niet zo groot is, maar wel een groot stuk land beheert. 
In totaal wel bijna 3x de stad Woerden! Kijk om je heen op de borden ;)";
$vraag["lang"][5][2][1] = "Bij de gebieden die erbij horen denk aan Gieltjesdorp, Portengen en Noordeinde";
$vraag["lang"][5][2][2] = "Het dorp hoort bij de gemeente Breukelen, maar ligt wel nog een behoorlijk stuk van Breukelen af";
$vraag["lang"][5][2][3] = "Kijk om je heen, naar de borden. Welke dorpen zie je allemaal?";

$vraag["lang"][6][0][0] = "park de grutto";
$vraag["lang"][6][0][1] = "grutto";
$vraag["lang"][6][1][0] = "Park de Grutto";
$vraag["lang"][6][1][1] = "Park de Zwaan";
$vraag["lang"][6][1][2] = "de Koet";
$vraag["lang"][6][1][3] = "Duivenpark";
$vraag["lang"][6][2][0] = "De volgende locatie is een park waar vaak vissers zitten. Het is een ideale plek om vogels te spotten, andere beestjes ook, maar het park is ook naar een vogel vernoemd. 
De vogel is een strandlopertje, heeft lange pootjes en is ook een weidevogel. Helaas steeds minder in de weide te vinden door habitatverlies. In 2015 is de vogel ook gekozen als nationale 
vogelsoort van Nederland.";
$vraag["lang"][6][2][1] = "De vogel staat op de rode lijst omdat hij steeds minder te vinden is, maar er zijn wel veel soorten van deze vogel in Nederland.";
$vraag["lang"][6][2][2] = "Van de vogelbescherming: `Meestgehoorde roep een luid en helder '(naam van de vogel)', waarbij de eerste lettergreep in toonhoogte stijgt en de tweede weer daalt.`";
$vraag["lang"][6][2][3] = "Deze vogels leven het meeste in het noorden en het westen van Nederland";

$vraag["lang"][7][0][0] = "oortjespad";
$vraag["lang"][7][1][0] = "Oortjespad";
$vraag["lang"][7][1][1] = "De Boerinn";
$vraag["lang"][7][1][2] = "Golfbaan Bentwoud";
$vraag["lang"][7][1][3] = "BatensteinBuiten";
$vraag["lang"][7][2][0] = "Rebustijd!";
$vraag["lang"][7][2][1] = "Geen hints beschikbaar ;)";
$vraag["lang"][7][2][2] = "Geen hints beschikbaar ;)";
$vraag["lang"][7][2][3] = "Geen hints beschikbaar ;)";
$vraag["lang"][7][3][0] = "img";
$vraag["lang"][7][3][1] = "media/images/tussenstop.png";

$vraag["lang"][8][0][0] = "schulenburch";
$vraag["lang"][8][1][0] = "De Schulenburch";
$vraag["lang"][8][1][1] = "Milandhof";
$vraag["lang"][8][1][2] = "Snellerpoort";
$vraag["lang"][8][1][3] = "De Vaart";
$vraag["lang"][8][2][0] = "En weer terug naar de eerste soort vragen. De volgende locatie is een locatie waar sommige van onze leden zich ook huis houden! Deze locatie zit naast een sportvereniging, 
en deze locatie kan ook afgehuurd worden.Er zit zelfs nog een bibliotheek naast of erbij, dus kortom veelzijdig!";
$vraag["lang"][8][2][1] = "In dit gebouw bevindt muziekvereniging Nieuw Leven Kamerik.";
$vraag["lang"][8][2][2] = "Op de weg van Kamerik naar Kanis is dit gebouw te vinden.";
$vraag["lang"][8][2][3] = "Naast dit gebouw zit voetbalvereniging Kamerik.";

$vraag["lang"][9][0][0] = "excelsior";
$vraag["lang"][9][0][1] = "speeldozen";
$vraag["lang"][9][0][2] = "clubhuis";
$vraag["lang"][9][1][0] = "Excelsior";
$vraag["lang"][9][1][1] = "Het clubhuis";
$vraag["lang"][9][1][2] = "De Speeldozen";
$vraag["lang"][9][1][3] = "Het clubhuis van Excelsior, de Speeldozen";
$vraag["lang"][9][2][0] = "We zijn alweer bijna aan het einde van de route gekomen! We gaan naar de laatste stop en het eindpunt van de tocht, en dat is:";
$vraag["lang"][9][2][1] = "Niet zo moeilijk denken hoor!";
$vraag["lang"][9][2][2] = "Tja, waar zijn we vandaag gestart?";
$vraag["lang"][9][2][3] = "Even die hersens laten kraken...";

require "connect.php";
$sql = 'SELECT * FROM userdata WHERE id=?;';
$usersearch = $pdo->prepare($sql);
$usersearch->execute([$_SESSION["id"]]);
$user = $usersearch->fetch();

if ($user["QUESTION"] == 0) {
    header("Location: location.php");
}

if ($user["checkpoint"] == 1) {
    $sql = 'UPDATE userdata SET starttime=? WHERE id=?;';
    $update = $pdo->prepare($sql);
    $update->execute([time(), $_SESSION["id"]]);
}

if ($user["checkpoint"] == 7 && $user["route"] == "kort" || $user["checkpoint"] == 10 && $user["route"] == "lang") {
    header("Location: end.php");
}

if ($user["route"] == "kort") {
    $route = 1;
} else {
    $route = 0;
}

if (isset($_POST["answer"])) {
    foreach ($vraag[$user["route"]][$user["checkpoint"]][0] as $key => $value) {
        if (str_contains(strtolower($_POST["answer"]), $value)) {
            $sql = 'UPDATE userdata SET checkpoint=?, QUESTION=? WHERE id=?';
            $update = $pdo->prepare($sql);
            $update->execute([$user["checkpoint"], 0, $user["id"]]);
            unset($_SESSION["strike"]);
            header("Location: question.php");
            $correct = 1;
        } else if (!isset($correct)) {
            $correct = 0;
        }
    }
}

if (isset($_POST["hint"])) {
    if (!isset($_SESSION["strike"])) {
        $_SESSION["strike"] = 0;
    } else {
        $_SESSION["strike"]++;
    }
}

if (!isset($_SESSION["id"])) {
    header("Location: index.php");
}
?>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vraagtijd!</title>
    <link rel="stylesheet" href="style.css">
    <script src="scripts/checkpoints.js"></script>
</head>

<body>
    <?php require "nav.php" ?>
    <div class="flexcommon">
        <h1>Vraag!</h1>
        <p class="location"><?= $vraag[$user["route"]][$user["checkpoint"]][2][0] ?></p>
        <?php if (isset($vraag[$user["route"]][$user["checkpoint"]][3])) : ?>
            <?php if ($vraag[$user["route"]][$user["checkpoint"]][3][0] == "img") : ?>
                <img src="<?= $vraag[$user["route"]][$user["checkpoint"]][3][1] ?>" alt="questionimg">
            <?php endif; ?>
            <?php if ($vraag[$user["route"]][$user["checkpoint"]][3][0] == "audio") : ?>
                <audio src="<?= $vraag[$user["route"]][$user["checkpoint"]][3][1] ?>" alt="questionaudio">
            <?php endif; ?>
        <?php endif; ?>
        <div class="register">
            <form method="post">
                <label for="answer" class="locationq">Wat is de locatie?</label>
                <input type="text" name="answer" id="answer">
                <input type="submit" value="Controleer!" class="hint">
                <input type="submit" value="Krijg een hint!" name="hint" class="hint martop">
            </form>
        </div>
        <?php if (isset($correct)) : ?>
            <?php if ($correct != 1) : ?>
                <p id="errors" class="msgerror">Helaas, niet de goede locatie!</p>
            <?php endif; ?>
        <?php endif; ?>
        <?php if (isset($_SESSION["strike"])) : ?>
            <?php if ($_SESSION["strike"] == 0) : ?>
                <p>Hint 1: <?= $vraag[$user["route"]][$user["checkpoint"]][2][1] ?></p>
            <?php elseif ($_SESSION["strike"] == 1) : ?>
                <p>Hint 1: <?= $vraag[$user["route"]][$user["checkpoint"]][2][1] ?></p>
                <p>Hint 2: <?= $vraag[$user["route"]][$user["checkpoint"]][2][2] ?></p>
            <?php elseif ($_SESSION["strike"] == 2) : ?>
                <p>Hint 1: <?= $vraag[$user["route"]][$user["checkpoint"]][2][1] ?></p>
                <p>Hint 2: <?= $vraag[$user["route"]][$user["checkpoint"]][2][2] ?></p>
                <p>Hint 3: <?= $vraag[$user["route"]][$user["checkpoint"]][2][3] ?></p>
            <?php elseif ($_SESSION["strike"] >= 3) : ?>
                <?php

                $rand1 = rand(0, 3);
                $rand2 = rand(0, 3);
                while ($rand2 == $rand1) {
                    $rand2 = rand(0, 3);
                }
                $rand3 = rand(0, 3);
                while ($rand3 == $rand1 || $rand3 == $rand2) {
                    $rand3 = rand(0, 3);
                }
                $rand4 = rand(0, 3);
                while ($rand4 == $rand1 || $rand4 == $rand2 || $rand4 == $rand3) {
                    $rand4 = rand(0, 3);
                }
                ?>
                <p>Als het met de hints nog steeds niet lukt, hebben we 4 opties voor je.</p>
                <p>Optie 1: <?= $vraag[$user["route"]][$user["checkpoint"]][1][$rand1] ?></p>
                <p>Optie 2: <?= $vraag[$user["route"]][$user["checkpoint"]][1][$rand2] ?></p>
                <p>Optie 3: <?= $vraag[$user["route"]][$user["checkpoint"]][1][$rand3] ?></p>
                <p>Optie 4: <?= $vraag[$user["route"]][$user["checkpoint"]][1][$rand4] ?></p>
            <?php endif; ?>
        <?php endif; ?>
    </div>
    <?php require "footer.php" ?>
</body>

</html>